\subsection{Manacher}
\begin{lstlisting}[language=C]
void Manacher(char S[],int N,int P[]){
	int mx=1,id=0;
	P[0]=1;
	for(int i=1;i<N;i++){
		if(mx>i) P[i]=min(P[2*id-i],mx-i);
		else P[i]=1;
		while(P[i]<=i&&S[i-P[i]]==S[i+P[i]]) P[i]++;
		if(i+P[i]>mx){
			mx=i+P[i];
			id=i;
		}
	}
}
\end{lstlisting}

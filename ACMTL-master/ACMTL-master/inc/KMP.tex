\subsection{KMP}
\begin{lstlisting}[language=C]
void getnext(char *s,int n,int *next){//字符串s,文本下标0~n-1,结果存于f
	next[0]=-1;//这是一个特例
	int i=0,j=-1;
	while(i<n){
		while(j!=-1&&s[i]!=s[j]) j=next[j];
		next[++i]=++j;//如果在这个位置失配了应该去哪试图配
	}
}
int KMP(char *S,int n,char *T,int m){//目标串S的前n个中出现了几次模式串T的前m个
	int i=0,j=0;
	int ans=0;
	getnext(T,m,next);
	while(i<n){
		while(j!=-1&&S[i]!=T[j]) j=next[j];
		i++,j++;
		if(j==m) ans++;
	}
	return ans;
}
\end{lstlisting} 
